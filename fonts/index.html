<html>
	<head>
		<meta http-equiv="Content-Type" content="plain/html; charset=UTF-8" />
		<link rel="stylesheet" href="../styles.css" type="text/css" />
		<meta name="keywords" content="шрифты,debian,linux" />
		<meta name="author" content="Владимир Ступин" />
		<!-- 2008-09-01 -->
		<title>Опять о шрифтах в Linux (Debian)</title>
	</head>
	<body>
		<p><a href="..">&larr;</a></p>

		<h1>Опять о шрифтах в Linux (Debian)</h1>

		<p>Проблема шрифтов для многих линуксоидов стоит особо остро. Надо признать, шрифты в Linux не особо радуют глаз человека, привыкшего к шрифтам Windows. Windows-шрифты по сравнению со шрифтами Linux кажутся чёткими, контрастными.</p>

		<p>Впрочем, справедливости ради, стоит сказать что у меня проблема эта остро встала лишь в Firefox2, который использует библиотеки GNOME.</p>

		<p>Кратко опишу те действия, которые я предпринял для настройки шрифтов.</p>

		<p>1. В разных статьях советуют первым делом выставить в xorg.conf DPI в 96x96. Все мои попытки сделать это различными способами не удались. X-сервер попросту ложил на эти настройки и всё-равно использовал привычные ему 100x100. Возможно это связано с тем, что я использую фирменный драйвер nvidia и этот драйвер не воспринимает настройки DPI.</p>

		<p>Посмотреть DPI запущенного X-сервера можно так:</p>

		<pre class="console">$ xdpyinfo | grep resolutions
resolution:    100x100 dots per inch</pre>

		<p>2. Советуют пересобрать библиотеку freefonts2 с поддержкой опции TT_CONFIG_OPTION_BYTECODE_INTERPRETER.</p>

		<p>Как я выяснил, эта опция в Debian уже включена специальным патчем! (Это действительно так, я видел этот патч своими глазами!)</p>

		<p>3. Советуют поиграться с настройками пакета fontconfig-config примерно таким образом.</p>

		<pre class="console"># dpkg-reconfigure fontconfig-config</pre>

		<p>Первый экран: выбираем "Native" для шрифтов, которые установлены в Debian по-умолчанию, или Autohinter, если используются шрифты от Microsoft.</p>

		<p>На втором экране выбираем: "Всегда" - если у Вас LCD-монитор (жидкокристаллический дисплей), и "Никогда" - если у вас CRT-монитор (электронно-лучевая трубка).</p>

		<p>На третьем выбираем вариант "Нет" в любом случае, поскольку масштабирование матричных шрифтов всегда выглядит плохо.</p>

		<p>Затем применяем сделанные изменения командой:</p>

		<pre class="console"># dpkg-reconfigure fontconfig</pre>

		<p>И перезапускаем X'ы.</p>

		<p>4. Выбрать каталоги со шрифтами в xorg.conf. Я у себя оставил лишь две строчки - fixed-шрифты, без которых X-сервер просто не запустится, и TTF-шрифты, которые хорошо масштабируются.</p>

		<p>В секции Files остались две строчки:</p>

		<pre class="code">FontPath        "/var/lib/defoma/x-ttcidfont-conf.d/dirs/TrueType"
FontPath        "/usr/share/fonts/X11/misc"</pre>

		<p>5. Обычно советуют установить шрифты от Microsoft (разработанные фирмой Monotype), которые находятся в виртуальном пакете msttcorefonts. На самом деле это скрипт, который скачивает шрифты из официальных публичных источников и с помощью утилиты cabextract извлекает их из самораспаковывающихся cab-архивов, дополненных exe-декомпрессором :)</p>

		<p>Сразу скажу, что шрифты эти я пробовал ставить, но они мне не понравились. В большинстве случаев шрифты выглядели вполне нормально, но в окне Firefox на некоторых сайтах они всё-таки выглядели ужасно.</p>

		<p>Я поискал статьи о текущем положении со шрифтами в Linux. И к моему счастью, Алексей Федорчук, в своей статье (см. №2) меня обрадовал. Как оказалось, в Linux вполне хватает качественных шрифтов.</p>

		<p>Шрифты Microsoft (они же Monotype) были мной снесены. Взамен я установил шрифты, имеющиеся в Linux:</p>

		<pre class="console"># aptitude install ttf-bitstream-vera
# aptitude install ttf-dejavu
# aptitude install ttf-freefont
# aptitude install ttf-linux-libertine
# aptitude install xfonts-terminus</pre>

		<p>6. Советуют прописать в домашнем каталоге специально настроенный файл .gtkrc-2.0, но и его изменение не оказывало заметных на глаз изменений в шрифтах Firefox.</p>

		<p>Чтобы добиться более-менее божеского вида шрифтов в Firefox, в его настройках я прописал использование следующих шрифтов родственных микрософтовским:</p>

		<ol>
			<li>Пропорциональный - без засечек, размер - 16,</li>

			<li>С засечками - DejaVu Serif,</li>

			<li>Без засечек - DejaVu Sans,</li>

			<li>Моноширинный - DejaVu Sans Mono, размер - 13,</li>

			<li>Наименьший размер шрифта - 10,</li>
		</ol>

		<p>и запретил использовать веб-сайтам свои шрифты вместо установленных.</p>

		<ol>
			<li><a href="http://ru.wikipedia.org/wiki/%D0%A8%D1%80%D0%B8%D1%84%D1%82">Википедия - Шрифт</a></li>

			<li><a href="http://citkit.ru/articles/1000/">Алексей Федорчук. И снова про шрифты в Иксах</a></li>

			<li><a href="http://citkit.ru/articles/369/">Владимир Попов. Рендеринг шрифтов в X Window: как в MS Windows и даже лучше</a></li>

			<li><a href="http://www.linux.org.ru/wiki/en/X-%D1%81%D0%B5%D1%80%D0%B2%D0%B5%D1%80">LOR-FAQ: X-сервер</a></li>

			<li><a href="http://www.linux.org.ru/wiki/en/Desktop">LOR-FAQ: Desktop</a></li>

			<li>В качестве шутки, в которой есть доля правды, тема на LORе: <a href="http://www.linux.org.ru/view-message.jsp?msgid=2978779">Ужасные шрифты в Linux (как можно терпеть такое?)</a></li>
		</ol>

		<p>Результат, в принципе, меня удовлетворил (до этого было гораздо страшнее):</p>

		<img src="screen.png" />

		<p>Как всегда, буду рад выслушать Ваши наблюдения и наработки по настройке шрифтов в Linux.</p>

		<p><a href="mailto:vladimir@stupin.su?subject=Опять о шрифтах в Linux (Debian)">Написать автору</a></p>

		<p><a href="..">&larr;</a></p>
	</body>
</html>
