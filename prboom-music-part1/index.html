<html>
	<head>
		<meta http-equiv="Content-Type" content="plain/html; charset=UTF-8" />
		<link rel="stylesheet" href="../styles.css" type="text/css" />
		<meta name="keywords" content="midi,timidity,prboom,doom,debian" />
		<meta name="author" content="Владимир Ступин" />
		<!-- 2009-10-17 -->
		<title>Музыка в PrBoom</title>
	</head>
	<body>
		<p><a href="..">&larr;</a></p>

		<h1>Музыка в PrBoom</h1>

		<p>Продолжая тему запуска старых игр от id Software в Linux, хочу написать о PrBoom. PrBoom - это свободный движок игры Doom. У меня в Debian эта игра запускалась со звуком, но почему-то без музыки. Как оказалось, исправить этот недостаток довольно просто.</p>

		<p>Во-первых, ставим пакет timidity:</p>

		<pre class="console"># aptitude install timidity</pre>

		<p>Во-вторых, вносим в файл /etc/default/timidity следующие изменения:</p>

		<pre class="code">TIM_ALSASEQ=true</pre>

		<p>В-третьих, перезапускаем MIDI-секвенсор:</p>

		<pre class="console"># /etc/init.d/timidity restart</pre>

		<p>В каталоге /dev/ должно появиться устройство midi:</p>

		<pre class="console">$ ls -la /dev/midi
crw-rw---- 1 root audio 14, 2 Окт 17 17:29 /dev/midi</pre>

		<p>Нужно убедиться, что пользователь который будет запускать игру, будет иметь доступ к этому устройству. Для этого пользователя достаточно включить в группу audio и при необходимости завершить сеанс и войти снова.</p>

		<p>После всех этих действий prboom всё равно не воспроизводил музыку и я обратился к страницам руководства. После непродолжительного чтения, я узнал что все настройки prboom'а находятся в файле ~/.prboom/prboom.cfg.</p>

		<p>Поиск по файлу конфигурации слова music дал следующие две опции: music_card, music_volume.</p>

		<p>Опция music_card располагалась под опцией sound_card, но в отличие от неё имела другое значение:</p>

		<pre class="code">sound_card                   -1
music_card                   0</pre>

		<p>После того, как я заменил значение опции music_card на -1, музыка заработала.</p>

		<p>В игре можно включить использование OpenGL и задать размер экрана (смотрите настройки в меню игры и конфигурационный файл). Спрайты объёмными от этого не станут, но качество картинки станет лучше.</p>

		<p>Чтобы поиграть в оригинальный Doom, нужно взять от игры для DOS файл с расширением WAD и указать PrBoom'у использовать его. Например вот так можно запустить первый Doom:</p>

		<pre class="console">$ prboom -IWAD DOOM.WAD</pre>

		<p>Игра хоть и старая, но кто однажды стал её фанатом, тот её никогда не забудет. Я умею играть на сложности Ultra Violence пользуясь только лишь одной клавиатурой. Да и тем, кто её никогда не видел, может понравиться, если не рассматривать её как замену более поздним играм, а относиться к ней как какой-нибудь казуальной игре вроде тетриса или зумы.</p>

		<p>Ну и напоследок, несколько скриншотов.</p>

		<p>FreeDoom:</p>

		<img src="freedom.png" />

		<p>Doom Ultimate E1M1. Перед входом в первую мясорубку:</p>

		<img src="doom1-1.png" />

		<p>Doom Ultimate E1M1. После выхода из мясорубки осталось мало здоровья - или бейся или фоткай:</p>

		<img src="doom1-2.png" />

		<p><a href="mailto:vladimir@stupin.su?subject=Музыка в PrBoom">Написать автору</a></p>

		<p><a href="..">&larr;</a></p>
	</body>
</html>
